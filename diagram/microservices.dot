// cat microservices.dot | docker container run --rm -i vladgolubev/dot2png > microservices.png

digraph architecture {
  rankdir=LR;
  
  // storage & config - #303F9F (dark blue)
  node[fillcolor="#303F9F" style="filled" fontcolor="white"];
  database[label="DB"]; 
  cache[label="cache"];
  logging[label="logging"];
  config[label="config"];

  // client-side Apps - #FFCCBC (light orange)
  node[fillcolor="#FFCCBC" style="filled" fontcolor="black"];
  ui[label="UI"];

  // microservices - #C8E6C9 (light green)
  node[fillcolor="#C8E6C9" style="filled" fontcolor="black"];
  file_service[label="file_service"]; 
  ip_service[label="ip_service"]; 
  reports_service[label="reports_service"];

  subgraph client_side_apps {
      ui -> {api_gateway};
      {rank=same; ui};
  }
  
  subgraph api_gateways {
      api_gateway -> {logging} [arrowhead=obox];
      api_gateway -> {file_service, ip_service, reports_service};
  }
  
  subgraph microservices {
      file_service -> {reports_service, logging} [arrowhead=obox];
      file_service -> {config, cache};
      ip_service -> {reports_service, logging} [arrowhead=obox];
      ip_service -> {config, cache};
      reports_service -> logging [arrowhead=obox];
      reports_service -> database;
  }
}
